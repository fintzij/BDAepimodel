<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jon Fintzi, Xiang Cui, Jon Wakefield, Vladimir Minin" />

<meta name="date" content="2017-02-15" />

<title>The BDAepimodel package for fitting stochastic epidemic models to disease prevalence data via Bayesian data augmentaiton</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">The BDAepimodel package for fitting stochastic epidemic models to disease prevalence data via Bayesian data augmentaiton</h1>
<h4 class="author"><em>Jon Fintzi, Xiang Cui, Jon Wakefield, Vladimir Minin</em></h4>
<h4 class="date"><em>2017-02-15</em></h4>



<p>This vignette demonstrates the functionality of the R package implementing the agent-based Bayesian data augmentation algorithm in Fintzi, Wakefield, and Minin (2016). The purpose of this document is to demonstrate how to simulate an epidemic and a dataset using the package, and how to implement the MCMC algorithm to perform inference. For details of the algorithm we refer the user to the original paper, which is available on arXiv (<a href="https://arxiv.org/abs/1606.07995" class="uri">https://arxiv.org/abs/1606.07995</a>). The example explored in this vignette (SIR model with binomially distributed prevalence counts) also corresponds to the stochastic epidemic model used in the original paper. The implementation is reasonably fast for progressive, non-recurrent stochastic epidemic models in populations as large as several thousand individuals, but is not yet optimized for large population inference. Future work and extensions, along with a more efficient implementation, will be made available in the ‘stemr’ package (<a href="https://github.com/fintzij/stemr" class="uri">https://github.com/fintzij/stemr</a>).</p>
<div id="installing-and-loading-the-bdaepimodel-package" class="section level2">
<h2>Installing and loading the BDAepimodel package</h2>
<p>The BDAepimodel package may be installed using the ‘devtools’ package as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">&quot;fintzij/BDAepimodel&quot;</span>,<span class="dt">build_vignettes=</span><span class="ot">TRUE</span>) 
<span class="kw">library</span>(BDAepimodel)</code></pre></div>
</div>
<div id="simulating-data" class="section level2">
<h2>Simulating data</h2>
<p>Suppose we want to simulate an epidemic with SIR dynamics, and to sample prevalence counts at a set of observation times. In order to simulate an epidemic and a dataset, we must specify several components of the stochastic epidemic model. We begin by creating functions to simulate from, and evaluate the log-density (<em>N.B.</em> it is important that the <em>log</em> density be returned!) of the measurement process. Strictly speaking, we do not need the density function yet, but we will need it for inference so we may as well declare it now. These functions will be called internally and should take three arguments, named ‘state’, ‘meas_vars’, and ‘params’ as input. The ‘state’ argument will be a matrix of compartment counts, the first column of which indicates observation time and subsequent columns which give the observed and augmented compartment counts. The suffixes “_observed“, and”_augmented&quot; are attached internally, but should be referenced within the measurement process function. The ‘meas_vars’ argument will be a character vector of compartment names. The ‘params’ argument will be a named numeric vector of model parameters. Note that in specifying these functions, it suffices to do so generically and that the user need not deal yet with the actual arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_meas_process &lt;-<span class="st"> </span>function(state, meas_vars, params){
          <span class="co"># in our example, rho will be the name of the binomial sampling probability parameter.</span>
          <span class="co"># this function returns a matrix of observed counts</span>
          <span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(state), 
                 <span class="dt">size =</span> state[,meas_vars], <span class="co"># binomial sample of the unobserved prevalenc</span>
                 <span class="dt">prob =</span> params[<span class="st">&quot;rho&quot;</span>])     <span class="co"># sampling probability</span>
}

d_meas_process &lt;-<span class="st"> </span>function(state, meas_vars, params, <span class="dt">log =</span> <span class="ot">TRUE</span>) {
          <span class="co"># note that the names of the measurement variables are endowed with suffixes &quot;_observed&quot; and &quot;_augmented&quot;. This is required.</span>
          <span class="co"># we will declare the names of the measurement variables shortly.</span>
          <span class="kw">dbinom</span>(<span class="dt">x =</span> state[, <span class="st">&quot;I_observed&quot;</span>], 
                 <span class="dt">size =</span> state[, <span class="st">&quot;I_augmented&quot;</span>], 
                 <span class="dt">prob =</span> params[<span class="st">&quot;rho&quot;</span>], <span class="dt">log =</span> log)
}</code></pre></div>
<p>Having created functions to simulate from and evaluate the log-density of the measurement process, we now initialize our stochastic epidemic model object. This initialization step will create objects that will govern the dynamics of the epidemic model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epimodel &lt;-<span class="st"> </span><span class="kw">init_epimodel</span>(<span class="dt">obstimes =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">105</span>, <span class="dt">by =</span> <span class="dv">7</span>),                             <span class="co"># vector of observation times</span>
                          <span class="dt">popsize =</span> <span class="dv">750</span>,                                              <span class="co"># population size</span>
                          <span class="dt">states =</span> <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;R&quot;</span>),                                  <span class="co"># compartment names</span>
                          <span class="dt">params =</span> <span class="kw">c</span>(<span class="dt">beta =</span> <span class="fl">0.00035</span>,                                  <span class="co"># infectivity parameter</span>
                                     <span class="dt">mu =</span> <span class="dv">1</span>/<span class="dv">7</span>,                                        <span class="co"># recovery rate</span>
                                     <span class="dt">rho =</span> <span class="fl">0.2</span>,                                       <span class="co"># binomial sampling probability</span>
                                     <span class="dt">S0 =</span> <span class="fl">0.9</span>, <span class="dt">I0 =</span> <span class="fl">0.03</span>, <span class="dt">R0 =</span> <span class="fl">0.07</span>),                 <span class="co"># initial state probabilities</span>
                          <span class="dt">rates =</span> <span class="kw">c</span>(<span class="st">&quot;beta * I&quot;</span>, <span class="st">&quot;mu&quot;</span>),                                <span class="co"># unlumped transition rates</span>
                          <span class="dt">flow =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, -<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> T),  <span class="co"># flow matrix</span>
                          <span class="dt">meas_vars =</span> <span class="st">&quot;I&quot;</span>,                                            <span class="co"># name of measurement variable</span>
                          <span class="dt">r_meas_process =</span> r_meas_process,                            <span class="co"># measurement process functions</span>
                          <span class="dt">d_meas_process =</span> d_meas_process)</code></pre></div>
<p>Let us go through each of the arguments to this function one-by-one. + <code>obstimes</code>: This is the vector of observation times at which prevalence is sampled. + <code>popsize</code>: Pretty self-explanatory, this one is the population size. + <code>states</code>: Character vector of model compartment names. + <code>params</code>: Named numeric vector of model parameters. The parameters governing the probability that an individual is in S, I, or R at time 0 are given by S0, I0, and R0. Appending 0 to the name of a model compartment identifies that parameter as an initial state parameter. + <code>rates</code>: Vector of strings that state how to compute the <em>unlumped</em> rates for each type of transition. See the supplement of Fintzi, Wakefield, and Minin (2016) for a discussion of the distinction between lumped and unlumped rates. + <code>flow</code>: Numeric matrix giving the change to the population of each model compartment corresponding to each transition event. States are given in columns of the flow matrix, and reaction events in rows. The columns are assumed to be in the same order as the <code>states</code> argument, while the rows correspond to the transition events in the <code>rates</code> argument. + <code>meas_vars</code>: Character vector giving the name of the observed model compartment. + <code>r_meas_process, d_meas_process</code>: The functions for sampling from and evaluating the log-density of the measurement process.</p>
<p>We now have everything we need to simulate an epidemic and a dataset. The <code>simulate_epimodel</code> function will return an ‘epimodel’ object, which among other objects contains the full latent epidemic path and a dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate the epidemic and the dataset. The lump argument instructs the simulation function to simulate the epidemic on the lumped state space of counts, which is more efficient than doing so on the unlumped state space of individuals. </span>
epimodel &lt;-<span class="st"> </span><span class="kw">simulate_epimodel</span>(<span class="dt">epimodel =</span> epimodel, <span class="dt">lump =</span> <span class="ot">TRUE</span>, <span class="dt">trim =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(<span class="dt">x =</span> epimodel$pop_mat[,<span class="st">&quot;time&quot;</span>], <span class="dt">y =</span> epimodel$pop_mat[,<span class="st">&quot;I&quot;</span>], <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="dv">5</span>, <span class="dv">200</span>), <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Prevalence&quot;</span>)
<span class="kw">points</span>(<span class="dt">x =</span> epimodel$dat[,<span class="st">&quot;time&quot;</span>], <span class="dt">y =</span> epimodel$dat[,<span class="st">&quot;I&quot;</span>])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Before proceeeding to inference, it will be useful to examine a few of the objects within the epimodel list, as we will need to understand these objects in order to construct transition kernels for the model parameters. First, let us examine the <code>obs_mat</code> matrix in the epimodel list, which contains the observed and latent counts for the compartment on which prevalence data is collected. This is the matrix that is actually passed to the <code>state</code> variable in the measurement process functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(epimodel$obs_mat)</code></pre></div>
<pre><code>##      time I_observed I_augmented
## [1,]    0          7          17
## [2,]    7          2          21
## [3,]   14          4          40
## [4,]   21         14          70
## [5,]   28         14          97
## [6,]   35         20          91</code></pre>
<p>As the MCMC runs and the latent path is updated, it is censused at each iteration and the latent compartments from which the data are emitted are copied into the columns ending in ’_augmented’. We note that there is no need for the user to ever create this matrix themselves when constructing a transition kernel as it is made available internally and may be accessed when we write the kernel functions.</p>
<p>We now turn our attention to a pair of objects that supply the complete collection of subject level paths. The first is a vector that gives the initial configuration of the population at the first observation time, named <code>init_config</code>. Subjects are coded from 1 to <code>popsize</code>. The codes in this vector correspond to the disease state of the subject, and are ordered as they were supplied to the <code>state</code> argument when the epimodel was initialized. In our example, S=1, I=2, R=3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(epimodel$init_config)</code></pre></div>
<pre><code>## .X1 .X2 .X3 .X4 .X5 .X6 
##   1   1   1   1   1   1</code></pre>
<p>The second object that identifies the collection of paths is the matrix which stores the sequence of transition times, subject IDs, and event codes, named <code>pop_mat</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(epimodel$pop_mat)</code></pre></div>
<pre><code>##            time  ID Event   S  I  R
## [1,] 0.00000000   0     0 680 17 53
## [2,] 0.06550962 486     1 679 18 53
## [3,] 0.07259891 691     2 679 17 54
## [4,] 0.17715201 590     1 678 18 54
## [5,] 0.34260513 143     1 677 19 54
## [6,] 0.57790414 633     1 676 20 54</code></pre>
<p>There are several aspects of the structure of this matrix that should be pointed out. The first column contains the times of the transition events and observations. The second column contains the ID for the subject that transitioned at each event time. The matrix is sorted by time. If a row in the observation matrix corresponds to an observation time, the ID code is 0. The third column corresponds to the code for each transition event. Again, the code for an observation is 0. The remaining observation codes correspond to the transition events in the order they were supplied when the epimodel object was initialized. Thus, in our example, infection and recoveries are coded 1 and 2, respectively. The remaining columns give the compartment counts at each event or observation time. Since we know the initial configuration of the system, we have a fully identified collection of subject-level paths. One final point to keep in mind is that this matrix will be expanded internally as we add buffer rows to avoid growing or shrinking the size of the matrix as the number of transition events changes. The matrix will still be sorted, but row corresponding to the final observation is tracked and is made available in the epimodel object. The object identifying the row number is named <code>ind_final_config</code>.</p>
</div>
<div id="inference" class="section level2">
<h2>Inference</h2>
<p>In order to conduct inference, we must first write transition kernels for the stochastic epidemic model parameters. We can access templates to assist in writing the transition kernels through the <code>templates()</code> function (see <code>help(templates)</code>). In our SIR model example, we are able to update all of the model parameters from their univariate full conditional distributions (see Table 1 in the original paper).</p>
<div id="writing-transition-kernels" class="section level3">
<h3>Writing transition kernels</h3>
<p>We will pass a list of functions for the transition kernels to the epimodel object. Each kernel function takes the whole epimodel list as its only argument, and therefore may access any object saved in the epimodel list. There is no need to write transition kernels for the initial state probability parameters. These will get sampled automatically using the Dirichlet-Multinomial conjugate distributions. To see how the kernel functions get called, the user should inspect lines 144-146 of the <code>fit_epimodel</code> function.</p>
<p>The first function we will write will be an Rcpp helper function for computing the sufficient statistics for the rate parameters in the SIR model based on the <code>pop_mat</code> matrix. This function will take as inputs the <code>pop_mat</code> object and the row number of the final configuration, and output a numeric vector of sufficient statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rcpp::<span class="kw">cppFunction</span>(<span class="st">&quot;Rcpp::NumericVector getSuffStats_SIR(const Rcpp::NumericMatrix&amp; pop_mat, const int ind_final_config) {</span>
<span class="st">                  </span>
<span class="st">          // initialize sufficient statistics</span>
<span class="st">          int num_inf = 0;       // number of infection events</span>
<span class="st">          int num_rec = 0;       // number of recovery events</span>
<span class="st">          double beta_suff = 0;  // integrated hazard for the infectivity</span>
<span class="st">          double mu_suff = 0;    // integrated hazard for the recovery</span>

<span class="st">          // initialize times</span>
<span class="st">          double cur_time = 0;              // current time</span>
<span class="st">          double next_time = pop_mat(0,0);  // time of the first event</span>
<span class="st">          double dt = 0;                    // time increment</span>
<span class="st">          </span>
<span class="st">          // compute the sufficient statistics - loop through the pop_mat matrix until</span>
<span class="st">          // reaching the row for the final observation time</span>
<span class="st">          for(int j = 0; j &lt; ind_final_config - 1; ++j) {</span>
<span class="st">          </span>
<span class="st">                    cur_time = next_time;         </span>
<span class="st">                    next_time = pop_mat(j+1, 0); // grab the time of the next event</span>
<span class="st">                    dt = next_time - cur_time;   // compute the time increment</span>
<span class="st">                    </span>
<span class="st">                    beta_suff += pop_mat(j, 3) * pop_mat(j, 4) * dt; // add S*I*(t_{j+1} - t_j) to beta_suff</span>
<span class="st">                    mu_suff += pop_mat(j, 4) * dt;                   // add I*(t_{j+1} - t_j) to mu_suff</span>
<span class="st">                    </span>
<span class="st">                    // increment the count for the next event</span>
<span class="st">                    if(pop_mat(j + 1, 2) == 1) {  </span>
<span class="st">                              num_inf += 1;</span>
<span class="st">                    } else if(pop_mat(j + 1, 2) == 2) {</span>
<span class="st">                              num_rec += 1;</span>
<span class="st">                    }</span>
<span class="st">          }</span>
<span class="st">                  </span>
<span class="st">          // return the vector of sufficient statistics for the rate parameters</span>
<span class="st">          return Rcpp::NumericVector::create(num_inf, beta_suff, num_rec, mu_suff);</span>
<span class="st">}&quot;</span>)</code></pre></div>
<p>We next create a function to perform Gibbs updates for the model parameters. To see a template of such a function, call <code>templates(&quot;gibbs&quot;)</code>. This function takes the epimodel list as input and returns an updated epimodel list. Note that the priors for the parameters are implicitly defined in this function (see comments in the code below for priors). Each kernel function that updates rate parameters must include function calls to update the sequence of rate matrices for the latent process, along with their eigen decompositions, as well as the log-likelihood of the latent process (<code>build_new_irms</code>, <code>buildEigenArray</code>, <code>calc_pop_likelihood</code>). These Each kernel function that updates measurement process parameters must include function calls to update the observed data log-likelihood (<code>calc_obs_likelihood</code>). A kernel ends with a call to the <code>update_params</code> function and returns the now updated epimodel list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gibbs_kernel_SIR &lt;-<span class="st"> </span>function(epimodel) {
          
          <span class="co"># get sufficient statistics using the previously compiled getSuffStats_SIR function (above)</span>
          suff_stats &lt;-<span class="st"> </span><span class="kw">getSuffStats_SIR</span>(epimodel$pop_mat, epimodel$ind_final_config)
          
          <span class="co"># update parameters from their univariate full conditional distributions</span>
          <span class="co"># Priors: beta ~ gamma(0.3, 1000)</span>
          <span class="co">#         mu   ~ gamma(1, 8)</span>
          <span class="co">#         rho  ~ beta(2, 7)</span>
          proposal          &lt;-<span class="st"> </span>epimodel$params <span class="co"># params is the vector of ALL model parameters</span>
          proposal[<span class="st">&quot;beta&quot;</span>]  &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">1</span>, <span class="fl">0.3</span> +<span class="st"> </span>suff_stats[<span class="dv">1</span>], <span class="dv">1000</span> +<span class="st"> </span>suff_stats[<span class="dv">2</span>])
          proposal[<span class="st">&quot;mu&quot;</span>]    &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">1</span>, <span class="dv">1</span> +<span class="st"> </span>suff_stats[<span class="dv">3</span>], <span class="dv">8</span> +<span class="st"> </span>suff_stats[<span class="dv">4</span>])
          proposal[<span class="st">&quot;rho&quot;</span>]   &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, <span class="dt">shape1 =</span> <span class="dv">2</span> +<span class="st"> </span><span class="kw">sum</span>(epimodel$obs_mat[, <span class="st">&quot;I_observed&quot;</span>]),
                                        <span class="dt">shape2 =</span> <span class="dv">7</span> +<span class="st"> </span><span class="kw">sum</span>(epimodel$obs_mat[, <span class="st">&quot;I_augmented&quot;</span>] -<span class="st"> </span>epimodel$obs_mat[, <span class="st">&quot;I_observed&quot;</span>]))
          
          <span class="co"># update array of rate matrices</span>
          epimodel &lt;-<span class="st"> </span><span class="kw">build_new_irms</span>(epimodel, proposal)
          
          <span class="co"># update the eigen decompositions (This function is built in and computes eigen decompositions analytically)</span>
          <span class="kw">buildEigenArray_SIR</span>(<span class="dt">real_eigenvals =</span> epimodel$real_eigen_values,
                              <span class="dt">imag_eigenvals =</span> epimodel$imag_eigen_values,
                              <span class="dt">eigenvecs      =</span> epimodel$eigen_vectors, 
                              <span class="dt">inversevecs    =</span> epimodel$inv_eigen_vectors, 
                              <span class="dt">irm_array      =</span> epimodel$irm, 
                              <span class="dt">n_real_eigs    =</span> epimodel$n_real_eigs, 
                              <span class="dt">initial_calc   =</span> <span class="ot">FALSE</span>)
          
          <span class="co"># get log-likelihood of the observations under the new parameters</span>
          obs_likelihood_new  &lt;-<span class="st"> </span><span class="kw">calc_obs_likelihood</span>(epimodel, <span class="dt">params =</span> proposal, <span class="dt">log =</span> <span class="ot">TRUE</span>) #### NOTE - log = TRUE
          
          <span class="co"># get the new population level CTMC log-likelihood</span>
          pop_likelihood_new  &lt;-<span class="st"> </span>epimodel$likelihoods$pop_likelihood_cur +
<span class="st">                    </span>suff_stats[<span class="dv">1</span>] *<span class="st"> </span>(<span class="kw">log</span>(proposal[<span class="st">&quot;beta&quot;</span>]) -<span class="st"> </span><span class="kw">log</span>(epimodel$params[<span class="st">&quot;beta&quot;</span>])) +
<span class="st">                    </span>suff_stats[<span class="dv">3</span>] *<span class="st"> </span>(<span class="kw">log</span>(proposal[<span class="st">&quot;mu&quot;</span>]) -<span class="st"> </span><span class="kw">log</span>(epimodel$params[<span class="st">&quot;mu&quot;</span>])) -
<span class="st">                    </span>suff_stats[<span class="dv">2</span>] *<span class="st"> </span>(proposal[<span class="st">&quot;beta&quot;</span>] -<span class="st"> </span>epimodel$params[<span class="st">&quot;beta&quot;</span>]) -<span class="st"> </span>
<span class="st">                    </span>suff_stats[<span class="dv">4</span>] *<span class="st"> </span>(proposal[<span class="st">&quot;mu&quot;</span>] -<span class="st"> </span>epimodel$params[<span class="st">&quot;mu&quot;</span>])
          
          <span class="co"># update parameters, likelihood objects, and eigen decompositions</span>
          epimodel  &lt;-
<span class="st">                    </span><span class="kw">update_params</span>(
                              epimodel,
                              <span class="dt">params =</span> proposal,
                              <span class="dt">pop_likelihood =</span> pop_likelihood_new,
                              <span class="dt">obs_likelihood =</span> obs_likelihood_new
                    )
          
          <span class="kw">return</span>(epimodel)
}</code></pre></div>
<p>In the Gibbs updates implemented in the function above, we first compute the sufficient statistics, and then sample new values for the rate parameters and the binomial sampling probability from their univariate full conditional distributions. Since we have updated all model parameters except the initial state distribution parameters, which are updated automatically, we supply the vector of model parameters, the new population level likelihood, and the new observed data log-likelihood to the <code>update_params</code> function.</p>
</div>
<div id="fitting-the-stochastic-epidemic-model" class="section level3">
<h3>Fitting the stochastic epidemic model</h3>
<p>We now have everything we need to estimate the stochastic epidemic model parameters. We will now reinitialize the epimodel object from the beginning, as if we had not previously initialized it for simulation, then initialize the MCMC settings and run the MCMC. Note that we must also supply parameters for the dirichlet prior distribution for the initial state probabilities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># grab the data that was simulated previously. No need to redefine the measurement process functions, they remain unchanged.</span>
dat &lt;-<span class="st"> </span>epimodel$dat 

chain &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># this was set by a batch script that ran chains 1, 2, and 3 in parallel</span>
<span class="kw">set.seed</span>(<span class="dv">52787</span> +<span class="st"> </span>chain)

<span class="co"># initial values for initial state parameters</span>
init_dist &lt;-<span class="st"> </span>MCMCpack::<span class="kw">rdirichlet</span>(<span class="dv">1</span>, <span class="kw">c</span>(<span class="dv">9</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span>))
epimodel &lt;-<span class="st"> </span><span class="kw">init_epimodel</span>(<span class="dt">popsize =</span> <span class="dv">750</span>,                                                       <span class="co"># population size</span>
                          <span class="dt">states =</span> <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;R&quot;</span>),                                           <span class="co"># compartment names</span>
                          <span class="dt">params =</span> <span class="kw">c</span>(<span class="dt">beta =</span> <span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.00035</span>, <span class="fl">5e-5</span>)),                      <span class="co"># per-contact infectivity rate</span>
                                     <span class="dt">mu =</span> <span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dv">1</span>/<span class="dv">7</span>, <span class="fl">0.02</span>)),                            <span class="co"># recovery rate</span>
                                     <span class="dt">rho =</span> <span class="kw">rbeta</span>(<span class="dv">1</span>, <span class="dv">21</span>, <span class="dv">75</span>),                                   <span class="co"># binomial sampling probability</span>
                                     <span class="dt">S0 =</span> init_dist[<span class="dv">1</span>], <span class="dt">I0 =</span> init_dist[<span class="dv">2</span>], <span class="dt">R0 =</span> init_dist[<span class="dv">3</span>]), <span class="co"># initial state probabilities</span>
                          <span class="dt">rates =</span> <span class="kw">c</span>(<span class="st">&quot;beta * I&quot;</span>, <span class="st">&quot;mu&quot;</span>),                                         <span class="co"># unlumped transition rates</span>
                          <span class="dt">flow =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, -<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> T),           <span class="co"># flow matrix</span>
                          <span class="dt">dat =</span> dat,                                                           <span class="co"># dataset</span>
                          <span class="dt">time_var =</span> <span class="st">&quot;time&quot;</span>,                                                   <span class="co"># name of time variable in the dataset</span>
                          <span class="dt">meas_vars =</span> <span class="st">&quot;I&quot;</span>,                                                     <span class="co"># name of measurement variable</span>
                          <span class="dt">initdist_prior =</span> <span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">2</span>, <span class="dv">5</span>), ### Parameters for the dirichlet prior distribution for the initial state probs
                          <span class="dt">r_meas_process =</span> r_meas_process,
                          <span class="dt">d_meas_process =</span> d_meas_process)</code></pre></div>
<p>Having initialized an epimodel object, we now proceed to set our MCMC settings and to run the MCMC. The MCMC output is accessible via <code>epimodel$results</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epimodel &lt;-<span class="st"> </span><span class="kw">init_settings</span>(epimodel,
                          <span class="dt">niter =</span> <span class="dv">10</span>,  <span class="co"># this was set to 100,000 in the paper</span>
                          <span class="dt">save_params_every =</span> <span class="dv">1</span>, 
                          <span class="dt">save_configs_every =</span> <span class="dv">2</span>, <span class="co"># this was set to 250 in the paper </span>
                          <span class="dt">kernel =</span> <span class="kw">list</span>(gibbs_kernel_SIR),
                          <span class="dt">configs_to_redraw =</span> <span class="dv">1</span>, <span class="co"># this was set to 75 in the paper</span>
                          <span class="dt">analytic_eigen =</span> <span class="st">&quot;SIR&quot;</span>, <span class="co"># compute eigen decompositions and matrix inverses analytically</span>
                          <span class="dt">ecctmc_method =</span> <span class="st">&quot;unif&quot;</span>)   <span class="co"># sample subject paths in interevent intervals via modified rejection sampling</span>

epimodel &lt;-<span class="st"> </span><span class="kw">fit_epimodel</span>(epimodel, <span class="dt">monitor =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## [1] &quot;Initialization attempt 10&quot;
## [1] &quot;Configuration initialized. Beginning MCMC.&quot;</code></pre>
<p>A matrix containing the posterior parameter samples is accessible within the <code>epimodel$results</code> object. The column names identify the parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(epimodel$results$params)</code></pre></div>
<pre><code>##              beta        mu       rho        S0         I0           R0
## [1,] 0.0003177038 0.1843949 0.2062529 0.9742683 0.02573172 2.242341e-15
## [2,] 0.0003049598 0.1731881 0.3155954 0.9761292 0.01816953 5.701301e-03
## [3,] 0.0003001248 0.1745280 0.3884158 0.9637472 0.03001486 6.237933e-03
## [4,] 0.0003217104 0.1649692 0.3595424 0.9664266 0.02831173 5.261691e-03
## [5,] 0.0003153391 0.1691622 0.3716975 0.9796174 0.01571351 4.669077e-03
## [6,] 0.0003098689 0.1642757 0.3835384 0.9625498 0.02623685 1.121340e-02</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ts.plot</span>(epimodel$results$params[,<span class="st">&quot;beta&quot;</span>], <span class="dt">ylab =</span> <span class="kw">expression</span>(beta))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">hist</span>(epimodel$results$params[,<span class="st">&quot;rho&quot;</span>]), <span class="dt">main =</span> <span class="st">&quot;Binomial sampling probability&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We may also be interested in summarizing the posterior distribution of the latent process. The function used to fit the stochastic epidemic model also caches the full latent paths at intervals specified by the <code>save_configs_every</code> argument to the MCMC settings funciton. We can plot the pointwise posterior distribution using the supplied plotting convenience function, <code>plot_latent_posterior</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_latent_posterior</span>(epimodel, 
                      <span class="dt">states =</span> <span class="st">&quot;I&quot;</span>, <span class="dt">times =</span> epimodel$obstimes, <span class="dt">cm =</span> <span class="st">&quot;mn&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, we can access the log-likelihood at each MCMC iteration via <code>epimodel$results$log_likelihood</code>, and the acceptances, including the acceptances for latent path proposals, via <code>epimodel$results$log_likelihood</code>. We accepted roughly 22 percent of the propossed latent path perturbations.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
